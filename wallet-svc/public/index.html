<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simple Wallet App</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Custom styles can go here if needed */
      .tab-button.active {
        @apply border-b-2 border-blue-500 text-blue-600;
      }
    </style>
  </head>
  <body class="bg-gray-100 font-sans">
    <div
      id="app"
      class="max-w-4xl mx-auto my-10 p-6 bg-white rounded-lg shadow-xl"
    >
      <h1 class="text-3xl font-bold text-center text-blue-700 mb-6">
        Simple Wallet Application
      </h1>

      <div v-if="!token" class="space-y-6">
        <h2 class="text-2xl font-semibold text-gray-800 border-b pb-4 mb-4">
          Welcome!
        </h2>

        <div class="flex border-b border-gray-200">
          <button
            @click="authTab = 'login'"
            :class="{'tab-button active': authTab === 'login', 'text-gray-600 hover:text-gray-800 py-2 px-4 block focus:outline-none': true}"
          >
            Login
          </button>
          <button
            @click="authTab = 'register'"
            :class="{'tab-button active': authTab === 'register', 'text-gray-600 hover:text-gray-800 py-2 px-4 block focus:outline-none': true}"
          >
            Register
          </button>
        </div>

        <div v-if="authTab === 'register'" class="mt-6">
          <div
            v-if="registerSuccess"
            class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4"
            role="alert"
          >
            {{ registerSuccess }}
          </div>
          <div
            v-if="registerError"
            class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4"
            role="alert"
          >
            {{ registerError }}
          </div>
          <div class="mb-4">
            <label
              for="registerEmail"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Email:</label
            >
            <input
              type="email"
              id="registerEmail"
              v-model="registerForm.email"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="Enter your email"
            />
          </div>
          <div class="mb-6">
            <label
              for="registerPassword"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Password:</label
            >
            <input
              type="password"
              id="registerPassword"
              v-model="registerForm.password"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="Enter your password"
            />
          </div>
          <button
            @click="registerUser"
            class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
          >
            Register
          </button>
        </div>

        <div v-if="authTab === 'login'" class="mt-6">
          <div
            v-if="loginError"
            class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4"
            role="alert"
          >
            {{ loginError }}
          </div>
          <div class="mb-4">
            <label
              for="loginEmail"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Email:</label
            >
            <input
              type="email"
              id="loginEmail"
              v-model="loginForm.email"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="Enter your email"
            />
          </div>
          <div class="mb-6">
            <label
              for="loginPassword"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Password:</label
            >
            <input
              type="password"
              id="loginPassword"
              v-model="loginForm.password"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="Enter your password"
            />
          </div>
          <button
            @click="loginUser"
            class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
          >
            Login
          </button>
        </div>
      </div>

      <div v-else>
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-semibold text-gray-800">Wallet Dashboard</h2>
          <button
            @click="logout"
            class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
          >
            Logout
          </button>
        </div>

        <div class="flex border-b border-gray-200 mb-6">
          <button
            @click="currentTab = 'overview'"
            :class="{'tab-button active': currentTab === 'overview', 'text-gray-600 hover:text-gray-800 py-2 px-4 block focus:outline-none': true}"
          >
            Overview
          </button>
          <button
            @click="currentTab = 'deposit'"
            :class="{'tab-button active': currentTab === 'deposit', 'text-gray-600 hover:text-gray-800 py-2 px-4 block focus:outline-none': true}"
          >
            Deposit
          </button>
          <button
            @click="currentTab = 'withdraw'"
            :class="{'tab-button active': currentTab === 'withdraw', 'text-gray-600 hover:text-gray-800 py-2 px-4 block focus:outline-none': true}"
          >
            Withdraw
          </button>
          <button
            @click="currentTab = 'transfer'"
            :class="{'tab-button active': currentTab === 'transfer', 'text-gray-600 hover:text-gray-800 py-2 px-4 block focus:outline-none': true}"
          >
            Send Money
          </button>
          <button
            @click="currentTab = 'transactions'"
            :class="{'tab-button active': currentTab === 'transactions', 'text-gray-600 hover:text-gray-800 py-2 px-4 block focus:outline-none': true}"
          >
            Transactions
          </button>
        </div>

        <div
          v-if="walletMessage"
          class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4"
          role="alert"
        >
          {{ walletMessage }}
        </div>
        <div
          v-if="walletError"
          class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4"
          role="alert"
        >
          {{ walletError }}
        </div>

        <div v-if="currentTab === 'overview'">
          <h3 class="text-xl font-semibold mb-4 text-blue-600">
            Wallet Overview
          </h3>
          <div
            v-if="balance !== null"
            class="bg-blue-50 p-4 rounded-lg shadow-sm"
          >
            <p class="text-lg text-gray-700">
              Current Balance:
              <span class="text-blue-700 font-bold text-2xl"
                >${{ parseFloat(balance).toFixed(2) }}</span
              >
            </p>
          </div>
          <div v-else class="bg-yellow-50 p-4 rounded-lg shadow-sm">
            <p class="text-lg text-gray-700">
              No wallet found. Please create one.
            </p>
            <button
              @click="createWallet"
              class="mt-4 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
            >
              Create Wallet
            </button>
          </div>
        </div>

        <div v-if="currentTab === 'deposit'">
          <h3 class="text-xl font-semibold mb-4 text-blue-600">
            Deposit Funds
          </h3>
          <div class="mb-4">
            <label
              for="depositAmount"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Amount:</label
            >
            <input
              type="number"
              id="depositAmount"
              v-model.number="depositForm.amount"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="Enter amount"
              min="0.01"
              step="0.01"
            />
          </div>
          <div class="mb-6">
            <label
              for="depositDescription"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Description (Optional):</label
            >
            <input
              type="text"
              id="depositDescription"
              v-model="depositForm.description"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="e.g., Salary, Gift"
            />
          </div>
          <button
            @click="depositMoney"
            class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
          >
            Deposit
          </button>
        </div>

        <div v-if="currentTab === 'withdraw'">
          <h3 class="text-xl font-semibold mb-4 text-blue-600">
            Withdraw Funds
          </h3>
          <div class="mb-4">
            <label
              for="withdrawAmount"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Amount:</label
            >
            <input
              type="number"
              id="withdrawAmount"
              v-model.number="withdrawForm.amount"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="Enter amount"
              min="0.01"
              step="0.01"
            />
          </div>
          <div class="mb-6">
            <label
              for="withdrawDescription"
              class="block text-gray-700 text-sm font-bold mb-2"
              >Description (Optional):</label
            >
            <input
              type="text"
              id="withdrawDescription"
              v-model="withdrawForm.description"
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline"
              placeholder="e.g., Groceries, Rent"
            />
          </div>
          <button
            @click="withdrawMoney"
            class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
          >
            Withdraw
          </button>
        </div>

        <div v-if="currentTab === 'transfer'">
          <h3 class="text-xl font-semibold mb-4 text-blue-600">
            Send Money to Another User
          </h3>
          <div
            v-if="transferError"
            class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4"
            role="alert"
          >
            {{ transferError }}
          </div>
          <div
            v-if="transferSuccess"
            class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4"
            role="alert"
          >
            {{ transferSuccess }}
          </div>

          <h4 class="text-lg font-medium mb-3">Select Recipient:</h4>
          <div
            v-if="users.length > 0"
            class="mb-6 border border-gray-200 rounded-lg p-4 max-h-60 overflow-y-auto"
          >
            <div
              v-for="user in users"
              :key="user.id"
              @click="selectRecipient(user)"
              :class="{'bg-blue-100 border-blue-500': transferForm.toEmail === user.email, 'bg-gray-50 border-gray-200': transferForm.toEmail !== user.email}"
              class="flex items-center justify-between p-3 mb-2 rounded-md cursor-pointer hover:bg-gray-100 border transition duration-150 ease-in-out"
            >
              <div>
                <p class="font-semibold text-gray-800">{{ user.email }}</p>
                <p class="text-sm text-gray-600">
                  Wallet ID: {{ user.Wallet ? user.Wallet.id : 'N/A' }}
                </p>
              </div>
              <p class="text-lg font-bold text-green-700">
                ${{ user.Wallet ? parseFloat(user.Wallet.balance).toFixed(2) :
                'N/A' }}
              </p>
            </div>
          </div>
          <p v-else class="text-gray-600 mb-4">No other users found.</p>

          <div v-if="transferForm.toEmail">
            <p class="mb-4 text-lg">
              You are sending money to:
              <span class="font-bold text-blue-600"
                >{{ transferForm.toEmail }}</span
              >
            </p>

            <div class="mb-4">
              <label
                for="transferAmount"
                class="block text-gray-700 text-sm font-bold mb-2"
                >Amount:</label
              >
              <input
                type="number"
                id="transferAmount"
                v-model.number="transferForm.amount"
                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                placeholder="Enter amount"
                min="0.01"
                step="0.01"
              />
            </div>
            <div class="mb-6">
              <label
                for="transferDescription"
                class="block text-gray-700 text-sm font-bold mb-2"
                >Description (Optional):</label
              >
              <input
                type="text"
                id="transferDescription"
                v-model="transferForm.description"
                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline"
                placeholder="e.g., For dinner, Loan repayment"
              />
            </div>
            <button
              @click="transferMoney"
              class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
            >
              Send Money
            </button>
          </div>
        </div>

        <div v-if="currentTab === 'transactions'">
          <h3 class="text-xl font-semibold mb-4 text-blue-600">
            Transaction History
          </h3>
          <div
            v-if="transactionsError"
            class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4"
            role="alert"
          >
            {{ transactionsError }}
          </div>
          <div v-if="transactions.length > 0" class="space-y-4">
            <div
              v-for="transaction in transactions"
              :key="transaction.id"
              class="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200"
            >
              <p class="text-md text-gray-800">
                <strong>ID:</strong> {{ transaction.id }}
              </p>
              <p class="text-md text-gray-800">
                <strong>Amount:</strong>
                <span
                  :class="{'text-green-600': ['deposit', 'received'].includes(transaction.type), 'text-red-600': ['withdrawal', 'transfer'].includes(transaction.type)}"
                >
                  ${{ parseFloat(transaction.amount).toFixed(2) }}
                </span>
              </p>
              <p class="text-md text-gray-800">
                <strong>Type:</strong>
                <span class="capitalize">{{ transaction.type }}</span>
              </p>
              <p class="text-md text-gray-800">
                <strong>Description:</strong> {{ transaction.description ||
                'N/A' }}
              </p>
              <p class="text-md text-gray-800 text-sm text-gray-500">
                <strong>Date:</strong> {{ new
                Date(transaction.createdAt).toLocaleString() }}
              </p>
              <button
                @click="viewTransaction(transaction.id)"
                class="mt-2 bg-gray-200 hover:bg-gray-300 text-gray-800 text-sm py-1 px-3 rounded focus:outline-none focus:shadow-outline"
              >
                View Details
              </button>
            </div>
          </div>
          <p v-else class="text-gray-600">No transactions found.</p>

          <div
            v-if="selectedTransaction"
            class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50"
          >
            <div class="bg-white rounded-lg p-6 shadow-xl max-w-sm w-full">
              <h3 class="text-xl font-semibold mb-4 text-blue-600">
                Transaction Details (ID: {{ selectedTransaction.id }})
              </h3>
              <p class="mb-2">
                <strong>Amount:</strong>
                <span
                  :class="{'text-green-600': ['deposit', 'received'].includes(selectedTransaction.type), 'text-red-600': ['withdrawal', 'transfer'].includes(selectedTransaction.type)}"
                >
                  ${{ parseFloat(selectedTransaction.amount).toFixed(2) }}
                </span>
              </p>
              <p class="mb-2">
                <strong>Type:</strong>
                <span class="capitalize">{{ selectedTransaction.type }}</span>
              </p>
              <p class="mb-2">
                <strong>Description:</strong> {{ selectedTransaction.description
                || 'N/A' }}
              </p>
              <p class="mb-4 text-sm text-gray-500">
                <strong>Date:</strong> {{ new
                Date(selectedTransaction.createdAt).toLocaleString() }}
              </p>
              <button
                @click="selectedTransaction = null"
                class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"
              >
                Close
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      new Vue({
        el: "#app",
        data: {
          token: "xx",
          // token: localStorage.getItem("jwt_token") || null,
          authTab: "login", // 'login' or 'register'
          currentTab: "overview", // 'overview', 'deposit', 'withdraw', 'transfer', 'transactions'
          registerForm: {
            email: "",
            password: "",
          },
          loginForm: {
            email: "",
            password: "",
          },
          depositForm: {
            amount: null, // Changed to null for better initial state
            description: "",
          },
          withdrawForm: {
            amount: null, // Changed to null
            description: "",
          },
          transferForm: {
            toEmail: "",
            amount: null, // Changed to null
            description: "",
          },
          balance: null,
          users: [], // To store list of other users
          transactions: [],
          selectedTransaction: null,
          registerSuccess: "",
          registerError: "",
          loginError: "",
          walletMessage: "",
          walletError: "",
          transferError: "", // New error for transfer
          transferSuccess: "", // New success for transfer
          transactionsError: "",
        },
        watch: {
          // Watch for changes in currentTab to trigger data fetching
          currentTab(newTab, oldTab) {
            this.clearMessages() // Clear messages when tab changes
            if (newTab === "overview" && this.token) {
              this.getWalletBalance()
            } else if (newTab === "transactions" && this.token) {
              this.getAllTransactions()
            } else if (newTab === "transfer" && this.token) {
              this.getAllUsers()
              this.transferForm.toEmail = "" // Clear selected recipient when navigating to tab
              this.transferForm.amount = null
              this.transferForm.description = ""
            }
          },
        },
        methods: {
          // --- Utility Methods ---
          clearMessages() {
            this.registerSuccess = ""
            this.registerError = ""
            this.loginError = ""
            this.walletMessage = ""
            this.walletError = ""
            this.transferError = ""
            this.transferSuccess = ""
            this.transactionsError = ""
          },
          setAuthHeader() {
            /* return ; 
            if (this.token) {
              axios.defaults.headers.common[
                "Authorization"
              ] = `Bearer ${this.token}`
            } else {
              delete axios.defaults.headers.common["Authorization"]
            } */
          },

          // --- User Authentication ---
          async registerUser() {
            this.clearMessages()
            if (!this.registerForm.email || !this.registerForm.password) {
              this.registerError = "Email and password are required."
              return
            }
            try {
              const response = await axios.post(
                "/api/users/register",
                this.registerForm
              )
              this.registerSuccess = response.data.message + ". Please log in."
              this.registerForm.email = ""
              this.registerForm.password = ""
              this.authTab = "login"
            } catch (error) {
              this.registerError =
                error.response?.data?.message || "Registration failed."
              console.error("Registration error:", error)
            }
          },
          async loginUser() {
            this.clearMessages()
            if (!this.loginForm.email || !this.loginForm.password) {
              this.loginError = "Email and password are required."
              return
            }
            try {
              axios.defaults.withCredentials = true
              const response = await axios.post(
                "/api/users/login",
                this.loginForm
              )
              this.token = response.data.token
              localStorage.setItem("jwt_token", this.token)
              this.setAuthHeader()
              this.loginForm.email = ""
              this.loginForm.password = ""
              await this.getWalletBalance()
              if (this.balance === null) {
                this.walletMessage =
                  "Logged in successfully! You can now create a wallet."
              } else {
                this.walletMessage = "Logged in successfully!"
              }
              this.getAllTransactions()
              this.currentTab = "overview"
            } catch (error) {
              this.loginError =
                error.response?.data?.message ||
                "Login failed. Check your credentials."
              console.error("Login error:", error)
            }
          },
          logout() {
            this.token = null
            localStorage.removeItem("jwt_token")
            this.setAuthHeader()
            this.balance = null
            this.users = [] // Clear users on logout
            this.transactions = []
            this.selectedTransaction = null
            this.clearMessages()
            this.authTab = "login"
            alert("Logged out successfully!")
          },

          // --- Wallet Core Features ---
          async createWallet() {
            this.clearMessages()
            try {
              const response = await axios.post("/api/wallet/create")
              this.walletMessage = response.data.message
              this.balance = response.data.wallet.balance
              this.getWalletBalance()
            } catch (error) {
              this.walletError =
                error.response?.data?.message || "Failed to create wallet."
              console.error("Create wallet error:", error)
            }
          },
          async getWalletBalance() {
            this.clearMessages()
            try {
              const response = await axios.get("/api/wallet/balance")
              this.balance = response.data.balance
            } catch (error) {
              if (error.response && error.response.status === 404) {
                this.balance = null
                this.walletError =
                  "No wallet found for this user. Please create one."
              } else {
                this.walletError =
                  error.response?.data?.message || "Failed to fetch balance."
              }
              console.error("Get balance error:", error)
            }
          },
          async depositMoney() {
            this.clearMessages()
            if (!this.depositForm.amount || this.depositForm.amount <= 0) {
              this.walletError = "Deposit amount must be a positive number."
              return
            }
            if (this.balance === null) {
              this.walletError = "Please create a wallet first."
              return
            }
            try {
              const response = await axios.post(
                "/api/wallet/deposit",
                this.depositForm
              )
              this.walletMessage = response.data.message
              this.balance = response.data.balance
              this.depositForm.amount = null
              this.depositForm.description = ""
              this.getAllTransactions()
            } catch (error) {
              this.walletError =
                error.response?.data?.message || "Deposit failed."
              console.error("Deposit error:", error)
            }
          },
          async withdrawMoney() {
            this.clearMessages()
            if (!this.withdrawForm.amount || this.withdrawForm.amount <= 0) {
              this.walletError = "Withdrawal amount must be a positive number."
              return
            }
            if (this.balance === null) {
              this.walletError = "Please create a wallet first."
              return
            }
            try {
              const response = await axios.post(
                "/api/wallet/withdraw",
                this.withdrawForm
              )
              this.walletMessage = response.data.message
              this.balance = response.data.balance
              this.withdrawForm.amount = null
              this.withdrawForm.description = ""
              this.getAllTransactions()
            } catch (error) {
              this.walletError =
                error.response?.data?.message ||
                "Withdrawal failed. Check balance."
              console.error("Withdrawal error:", error)
            }
          },

          // --- User and Transfer Features ---
          async getAllUsers() {
            this.clearMessages()
            try {
              const response = await axios.get("/api/users/users")
              // Filter out the current logged-in user from the list
              this.users = response.data.users.filter(
                (user) => user.email !== this.loginForm.email
              )
            } catch (error) {
              this.transferError =
                error.response?.data?.message || "Failed to fetch user list."
              console.error("Get users error:", error)
            }
          },
          selectRecipient(user) {
            this.transferForm.toEmail = user.email
            this.transferSuccess = "" // Clear previous success message
            this.transferError = "" // Clear previous error message
          },
          async transferMoney() {
            this.clearMessages()
            if (!this.transferForm.toEmail) {
              this.transferError = "Please select a recipient."
              return
            }
            if (!this.transferForm.amount || this.transferForm.amount <= 0) {
              this.transferError = "Transfer amount must be a positive number."
              return
            }
            if (this.balance === null) {
              this.transferError = "Please create a wallet first."
              return
            }
            try {
              const response = await axios.post(
                "/api/wallet/transfer",
                this.transferForm
              )
              this.transferSuccess = response.data.message
              this.balance = response.data.balance
              this.transferForm.toEmail = ""
              this.transferForm.amount = null
              this.transferForm.description = ""
              this.getAllTransactions() // Refresh transactions for both sender and receiver
              this.getAllUsers() // Refresh users to show updated balances
            } catch (error) {
              this.transferError =
                error.response?.data?.error ||
                error.response?.data?.message ||
                "Transfer failed."
              console.error("Transfer money error:", error)
            }
          },

          // --- Transaction Management ---
          async getAllTransactions() {
            this.clearMessages()
            try {
              const response = await axios.get("/api/transactions")
              this.transactions = response.data.transactions
            } catch (error) {
              this.transactionsError =
                error.response?.data?.message || "Failed to fetch transactions."
              console.error("Get transactions error:", error)
            }
          },
          async viewTransaction(id) {
            this.clearMessages()
            try {
              const response = await axios.get(`/api/transactions/${id}`)
              this.selectedTransaction = response.data.transaction
            } catch (error) {
              this.transactionsError =
                error.response?.data?.message ||
                `Failed to fetch transaction with ID ${id}.`
              console.error("View transaction error:", error)
            }
          },
        },
        created() {
          // console.log("Vue instance createdxxx", document.cookie)
          this.setAuthHeader()
          if (this.token) {
            this.getWalletBalance()
            this.getAllTransactions()
            this.getAllUsers() // Fetch users on initial load if logged in
          }
        },
      })
    </script>
  </body>
</html>
